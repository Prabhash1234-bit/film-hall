<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Film Hall Booking</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    select {
      margin-bottom: 20px;
      padding: 10px;
      font-size: 16px;
    }
    .movie {
      border: 1px solid #ccc;
      margin-bottom: 20px;
      padding: 10px;
      border-radius: 10px;
    }
    .movie img {
      width: 100%;
      max-width: 300px;
    }
  </style>
</head>
<body>

  <h2>ðŸŽ¥ Welcome to Film Hall</h2>
  <p>Select a Theatre:</p>
  <select id="theatreSelect">
    <option value="">-- Choose Theatre --</option>
  </select>

  <div id="movieList"></div>

  <script>
    // ðŸ” Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCyHt7uB5FG06U1mYyi8tVWkMufWwDP7Q8",
      authDomain: "geometric-bolt-436910-h2.firebaseapp.com",
      projectId: "geometric-bolt-436910-h2",
      storageBucket: "geometric-bolt-436910-h2.appspot.com",
      messagingSenderId: "309504865367",
      appId: "1:309504865367:web:a408f1f396cb5ee1be1b61"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const theatreSelect = document.getElementById("theatreSelect");
    const movieList = document.getElementById("movieList");

    // ðŸ”½ Load theatre list into dropdown
    db.collection("theatres").get().then(snapshot => {
      snapshot.forEach(doc => {
        const option = document.createElement("option");
        option.value = doc.id;
        option.textContent = doc.data().name;
        theatreSelect.appendChild(option);
      });
    });

    // ðŸŽ¬ Load movies when theatre selected
    theatreSelect.addEventListener("change", () => {
      movieList.innerHTML = "";
      const theatreId = theatreSelect.value;
      if (!theatreId) return;

      db.collection("theatres").doc(theatreId).collection("movies").get()
        .then(snapshot => {
          if (snapshot.empty) {
            movieList.innerHTML = "<p>No movies found for this theatre.</p>";
            return;
          }
          snapshot.forEach(doc => {
            const movie = doc.data();
            const div = document.createElement("div");
            div.className = "movie";
            div.innerHTML = `
              <h3>${movie.title}</h3>
              <img src="${movie.posterURL}" alt="${movie.title}" />
              <p>Price: â‚¹${movie.price}</p>
              <p>Showtimes: ${movie.showtimes.join(", ")}</p>
              <a href="seat-booking.html?theatreId=${theatreId}&movieId=${doc.id}">ðŸŽŸ Book Now</a>
            `;
            movieList.appendChild(div);
          });
        });
    });
  </script>
</body>
</html>
