<!DOCTYPE html>
<html>
<head>
  <title>Film Hall - Movie List</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .movie-card {
      border: 1px solid #ccc;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .movie-card img {
      max-width: 200px;
      border-radius: 10px;
    }
    .movie-info {
      display: flex;
      gap: 20px;
      align-items: center;
    }
    .movie-actions {
      margin-top: 10px;
    }
    select {
      padding: 5px;
    }
    button {
      padding: 6px 12px;
      border: none;
      background: #007BFF;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h2>Select a Theatre</h2>
<select id="theatreDropdown">
  <option value="">-- Select Theatre --</option>
</select>

<div id="movieList"></div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

<script>
    const firebaseConfig = {
  apiKey: "AIzaSyCOEWNxz-PSgZd-iE19O8ykM4yCullRVAQ",
  authDomain: "film-hall-booking.firebaseapp.com",
  projectId: "film-hall-booking",
  storageBucket: "film-hall-booking.firebasestorage.app",
  messagingSenderId: "307732411395",
  appId: "1:307732411395:web:44377a6f4f30259e7c0a36",
  measurementId: "G-3HKF4JPPFT"
};

  // Initialize
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const theatreDropdown = document.getElementById('theatreDropdown');
  const movieList = document.getElementById('movieList');

  // Load theatre options
  async function loadTheatres() {
    const snapshot = await db.collection('theatres').get();
    snapshot.forEach(doc => {
      const option = document.createElement('option');
      option.value = doc.id;
      option.textContent = doc.data().name;
      theatreDropdown.appendChild(option);
    });
  }

  // Load movies for selected theatre
  async function loadMovies(theatreId) {
    movieList.innerHTML = '';
    const snapshot = await db.collection('theatres').doc(theatreId).collection('movies').get();
    snapshot.forEach(doc => {
      const data = doc.data();
      const movieCard = document.createElement('div');
      movieCard.className = 'movie-card';
      movieCard.innerHTML = `
        <div class="movie-info">
          <img src="${data.posterURL}" alt="${data.title}" />
          <div>
            <h3>${data.title}</h3>
            <p>Price: ₹${data.price}</p>
            <label>Showtime:
              <select>
                ${data.showtimes.map(show => `<option value="${show}">${show}</option>`).join('')}
              </select>
            </label>
            <div class="movie-actions">
              <button onclick="bookTicket('${theatreId}', '${doc.id}')">Book Now</button>
            </div>
          </div>
        </div>
      `;
      movieList.appendChild(movieCard);
    });
  }

  function bookTicket(theatreId, movieId) {
    window.location.href = `seat-booking.html?theatre=${theatreId}&movie=${movieId}`;
  }

  theatreDropdown.addEventListener('change', () => {
    const selectedTheatre = theatreDropdown.value;
    if (selectedTheatre) {
      loadMovies(selectedTheatre);
    }
  });

  loadTheatres();
</script>

</body>
</html>
